var worldcupApp=angular.module("worldcup2015",[]).factory("_",function(){return window._}).factory("moment",function(){return window.moment});worldcupApp.config(["$interpolateProvider",function(e){e.startSymbol("[["),e.endSymbol("]]")}]),worldcupApp.controller("ScheduleCtrl",["$scope","MatchesSvc","_","$log","moment",function(e,t,a,n,c){"use strict";e.timeFlag=!1,e.toggleTimeFlag=function(){e.timeFlag=!e.timeFlag},t.getAllMatches().success(function(a){t.setMatches(a.matches),e.dates=t.getAllMatchDates(),e.venues=t.getAllVenues(),e.showTodaysMatches=function(){var t=new Date,a=t.getDate(),n=t.getMonth()+1,c=t.getFullYear();10>a&&(a="0"+a),10>n&&(n="0"+n),t=c+"-"+n+"-"+a,e.onDateSelect(t),s()},e.showTodaysMatches()}),e.month=function(e){return"2"===e.substr(6,1)?"Feb":"Mar"},e.dateOfMonth=function(e){return e.substr(8,2)},e.getTime=function(t){return e.timeFlag?e.month(t.match_date).toUpperCase()+" "+e.dateOfMonth(t.match_date).toUpperCase()+" "+t.start_time.toUpperCase():c(t.match_datetime).format("MMM DD hh:mm A").toUpperCase()},e.selectedMatches={},e.onDateSelect=function(a,n){n=n||!1,!e.staySelected&&n&&(e.staySelected=!0),e.deselectAll(),e.selectedMatches=t.getMatchesForDate(a),o(),l()};var s=function(){e.dates=a.map(e.dates,function(t){return a.each(e.selectedMatches,function(e){e.match_date===t.date&&(t.selected=!0)}),t})},o=function(){e.teams=a.map(e.teams,function(t){return a.each(e.selectedMatches,function(e){(e.team_one_long===t.name||e.team_two_long===t.name)&&(t.selected=!0)}),t})},l=function(){e.venues=a.map(e.venues,function(t){return a.each(e.selectedMatches,function(e){e.city===t.city&&(t.selected=!0)}),t})};e.teams=[{name:"England",pool:"A",selected:!1},{name:"Australia",pool:"A",selected:!1},{name:"Sri Lanka",pool:"A",selected:!1},{name:"Bangladesh",pool:"A",selected:!1},{name:"New Zealand",pool:"A",selected:!1},{name:"Afghanistan",pool:"A",selected:!1},{name:"Scotland",pool:"A",selected:!1},{name:"South Africa",pool:"B",selected:!1},{name:"India",pool:"B",selected:!1},{name:"Pakistan",pool:"B",selected:!1},{name:"West Indies",pool:"B",selected:!1},{name:"Zimbabwe",pool:"B",selected:!1},{name:"Ireland",pool:"B",selected:!1},{name:"United Arab Emirates",pool:"B",selected:!1}],e.teamsInPool=function(t){for(var a,n=[],c=0;a=e.teams[c];c++)a.pool===t&&n.push(a);return n},e.onTeamSelect=function(a,n){n=n||!1,!e.staySelected&&n&&(e.staySelected=!0),e.deselectAll(),e.selectedMatches=t.getMatchesForTeam(a),s(),l()},e.onVenueSelect=function(a,n){n=n||!1,!e.staySelected&&n&&(e.staySelected=!0),e.deselectAll(),e.selectedMatches=t.getMatchesForVenue(a),s(),o()},e.deselectAll=function(){e.staySelected||(e.selectedMatches={});for(var t,a=0;t=e.dates[a];a++)t.selected=!1;for(var n,a=0;n=e.teams[a];a++)n.selected=!1;for(var c,a=0;c=e.venues[a];a++)c.selected=!1}}]),angular.module("worldcup2015").service("MatchesSvc",["_","moment","$http",function(e,t,a){this.matches=null,this.setMatches=function(e){this.matches=e},this.getAllMatches=function(){var e={itinora:(new Date).getTime()},t={params:e};return a.get("/static/data/matches.json",t)},this.getAllVenues=function(){return e.unique(e.map(this.matches,function(e){return{city:e.city,stadium:e.stadium,selected:!1}}),!1,function(e){return e.city})},this.getAllMatchDates=function(){return e.unique(e.sortBy(e.map(this.matches,function(e){return{date:e.match_date,selected:!1,pool:e.pool}}),"date"),!1,function(e){return e.date})},this.getMatchesForDate=function(t){return e.where(this.matches,{match_date:t})},this.getMatchesForTeam=function(t){return e.filter(this.matches,function(e){return e.team_one_long===t.name||e.team_two_long===t.name})},this.getMatchesForVenue=function(t){return e.where(this.matches,{city:t.city})}}]);